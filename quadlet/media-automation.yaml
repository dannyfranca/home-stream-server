# Media Automation Pod
# Containers: sonarr, radarr, bazarr
# These services communicate via localhost within the pod
#
# Auto-generated from template - edit quadlet/templates/ for changes
apiVersion: v1
kind: Pod
metadata:
  name: media-automation
  labels:
    app: media-automation
spec:
  containers:
    # =========================================================================
    # Sonarr - TV Show Automation
    # =========================================================================
    - name: sonarr
      image: lscr.io/linuxserver/sonarr:4.0.16
      env:
        - name: PUID
          value: "{{PUID}}"
        - name: PGID
          value: "{{PGID}}"
        - name: TZ
          value: "{{TZ}}"
      ports:
        - containerPort: 8989
          hostPort: 8989
      volumeMounts:
        - name: sonarr-config
          mountPath: /config
        - name: data
          mountPath: /data

    # =========================================================================
    # Radarr - Movie Automation
    # =========================================================================
    - name: radarr
      image: lscr.io/linuxserver/radarr:6.0.4
      env:
        - name: PUID
          value: "{{PUID}}"
        - name: PGID
          value: "{{PGID}}"
        - name: TZ
          value: "{{TZ}}"
      ports:
        - containerPort: 7878
          hostPort: 7878
      volumeMounts:
        - name: radarr-config
          mountPath: /config
        - name: data
          mountPath: /data

    # =========================================================================
    # Bazarr - Subtitle Downloads
    # =========================================================================
    - name: bazarr
      image: lscr.io/linuxserver/bazarr:1.5.3
      env:
        - name: PUID
          value: "{{PUID}}"
        - name: PGID
          value: "{{PGID}}"
        - name: TZ
          value: "{{TZ}}"
      ports:
        - containerPort: 6767
          hostPort: 6767
      volumeMounts:
        - name: bazarr-config
          mountPath: /config
        - name: media
          mountPath: /data/media

  volumes:
    - name: sonarr-config
      persistentVolumeClaim:
        claimName: sonarr-config
    - name: radarr-config
      persistentVolumeClaim:
        claimName: radarr-config
    - name: bazarr-config
      persistentVolumeClaim:
        claimName: bazarr-config
    - name: data
      hostPath:
        path: {{DATA_PATH}}
        type: Directory
    - name: media
      hostPath:
        path: {{DATA_PATH}}/media
        type: Directory
